



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://pages.charlesreid1.com/pod-webhooks/adding/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="..">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.3">
    
    
      
        <title>Adding Webhooks - pod-webhooks</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.451f80e5.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../css/custom.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="blue">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../#adding-new-hooks" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://pages.charlesreid1.com/pod-webhooks" title="pod-webhooks" class="md-header-nav__button md-logo">
          
            <i class="md-icon">dns</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                pod-webhooks
              </span>
              <span class="md-header-nav__topic">
                Adding Webhooks
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://git.charlesreid1.com/docker/pod-webhooks" title="Go to repository" class="md-source" data-md-source="">
    
    <div class="md-source__repository">
      pod-webhooks
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://pages.charlesreid1.com/pod-webhooks" title="pod-webhooks" class="md-nav__button md-logo">
      
        <i class="md-icon">dns</i>
      
    </a>
    pod-webhooks
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://git.charlesreid1.com/docker/pod-webhooks" title="Go to repository" class="md-source" data-md-source="">
    
    <div class="md-source__repository">
      pod-webhooks
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Adding Webhooks
      </label>
    
    <a href="./" title="Adding Webhooks" class="md-nav__link md-nav__link--active">
      Adding Webhooks
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#adding-new-hooks" title="Adding New Hooks" class="md-nav__link">
    Adding New Hooks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debugging-failed-hooks" title="Debugging Failed Hooks" class="md-nav__link">
    Debugging Failed Hooks
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../running/" title="Running Captain Hook" class="md-nav__link">
      Running Captain Hook
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../services/" title="Captain Hook Startup Services" class="md-nav__link">
      Captain Hook Startup Services
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../canary/" title="Captain Hook's Canary" class="md-nav__link">
      Captain Hook's Canary
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#adding-new-hooks" title="Adding New Hooks" class="md-nav__link">
    Adding New Hooks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debugging-failed-hooks" title="Debugging Failed Hooks" class="md-nav__link">
    Debugging Failed Hooks
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Adding Webhooks</h1>
                
                <h2 id="adding-new-hooks">Adding New Hooks<a class="headerlink" href="#adding-new-hooks" title="Permanent link">&para;</a></h2>
<p>To add a hook to Captain Hook:</p>
<ol>
<li>
<p>Create an executable script in <a href="https://git.charlesreid1.com/bots/b-captain-hook">bots/b-captain-hook</a>
   on git.charlesreid1.com with the name of the action, the name of the repo (not the owner),
   and the name of the branch in the filename. For example, <code>push-my-dotfiles-master</code> would be 
   matched every time I <code>push</code> changes to the <code>master</code> branch  of any repository named <code>my-dotfiles</code>.</p>
</li>
<li>
<p>Add, commit, and push your hook to the master branch of Captain Hook</p>
</li>
<li>
<p>Wait about 15 seconds for the canary script to run (it has to update
   the Captain Hook git repo running on the remote server to the latest version
   and restart the webhooks-subdomains docker pod.)</p>
</li>
<li>
<p>Open the <code>my-dotfiles</code> repository on git.charlesreid1.com, go to the
   Settings &gt; Webhooks page, and add a Gitea webhook.</p>
</li>
<li>
<p>Enter info:</p>
<p>a. Payload URL is the Captain Hook server, which is <code>https://hooks.charlesreid1.com/webhook</code>.
b. Content type is <code>application/json</code>
c. Secret is (that's my little secret)
d. Pick what events you would like to trigger webhooks, usually "just the push event"</p>
</li>
<li>
<p>Save the webhook, then click on the webhook again to open it back up.
   Scroll down to the bottom right and click "Test Delivery". </p>
</li>
</ol>
<p>You should see a green success sign. </p>
<h2 id="debugging-failed-hooks">Debugging Failed Hooks<a class="headerlink" href="#debugging-failed-hooks" title="Permanent link">&para;</a></h2>
<p>If you see a red warning sign:</p>
<ul>
<li>Ensure the webhooks docker pod is actually running okay (<code>docker ps</code> on the host machine)</li>
<li>Ensure port 5000 is open in the Captain Hook container, and on the host machine</li>
<li>Ensure you can see port 5000 of the <code>pod-webhooks</code> host machine from the <code>pod-charlesreid1</code> host machine</li>
<li>Ensure there is actually a hook in the <code>hooks/</code> directory of the Captain Hook repo</li>
</ul>
<p>Captain Hook repo: <a href="https://git.charlesreid1.com/bots/b-captain-hook">https://git.charlesreid1.com/bots/b-captain-hook</a></p>
<p>Captain Hook repo (Github mirror): <a href="https://github.com/charlesreid1-docker/b-captain-hook">https://github.com/charlesreid1-docker/b-captain-hook</a></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href=".." title="Home" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Home
              </span>
            </div>
          </a>
        
        
          <a href="../running/" title="Running Captain Hook" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Running Captain Hook
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 <a href="https://charlesreid1.com">Charles Reid</a>, released under the <a href="https://opensource.org/licenses/MIT">MIT license</a>
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.e72fd936.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="../search/main.js"></script>
      
    
    
      
    
  </body>
</html>